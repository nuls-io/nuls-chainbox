# NULS ChainBox
## NULS ChainBoxæ˜¯ä»€ä¹ˆ

ChainBoxæ˜¯ä¸€ä¸ªå¿«é€Ÿæ­å»ºåŒºå—é“¾çš„å·¥å…·ï¼Œå°è£…äº†è´¦æœ¬ï¼Œè´¦æˆ·ï¼Œäº¤æ˜“ï¼ŒåŒºå—ï¼Œå…±è¯†ï¼Œç½‘ç»œå…­ä¸ªåº•å±‚æ¨¡å—ï¼Œå±è”½äº†åˆ†å¸ƒå¼æ•°æ®å­˜å‚¨ã€ç‚¹å¯¹ç‚¹ä¼ è¾“ã€å…±è¯†æœºåˆ¶ã€åŠ å¯†ç®—æ³•ç­‰å¤æ‚åŒºå—é“¾æŠ€æœ¯ï¼Œå¼€å‘è€…å¯ä½¿ç”¨å®ƒå®ç°åˆ†é’Ÿçº§æ­å»ºTPSè¾¾1000çš„åŸºç¡€é“¾ï¼Œæˆ–æ ¹æ®æ ‡å‡†é€šä¿¡åè®®å¼€å‘ä¸šåŠ¡æ¨¡å—ï¼Œç„¶åé€šè¿‡chainboxé©±åŠ¨ç»„æˆä¸€æ¡å…¨æ–°çš„åº”ç”¨é“¾

## ä¸ºä»€ä¹ˆéœ€è¦ChainBox
 NULS ChainBoxè®¾è®¡çš„åˆè¡·æ˜¯å¸®åŠ©ä¼ä¸šæˆ–åº”ç”¨å¼€å‘è€…åœ¨åŒºå—é“¾ä¸Šèƒ½å¿«é€Ÿæ„å»ºåº”ç”¨ï¼Œå¹¶ä¸“æ³¨è‡ªå·±çš„ä¸šåŠ¡å®ç°ï¼Œæ— éœ€å…³å¿ƒæ™¦æ¶©ã€å¤æ‚çš„åŒºå—é“¾åº•å±‚æŠ€æœ¯ã€‚


## ç‰¹ç‚¹
NULS ChainBoxæœ¬è´¨ä¸Šæ˜¯NULS2.0çš„ä¸€ä¸ªæ‰©å±•åº”ç”¨ï¼Œå®ƒçš„å®šä½æ˜¯ä¸€ç«™å¼åŒºå—é“¾å¼€å‘å¹³å°ï¼Œå®ƒæœ‰3ä¸ªæ ¸å¿ƒç‰¹ç‚¹ï¼š

- å¿«é€Ÿæ­å»ºå¼€å‘ç¯å¢ƒ

- é€šè¿‡æ¨¡æ¿é™ä½åº”ç”¨å¼€å‘é—¨æ§›

- é€šè¿‡çº¦å®šå’Œè„šæœ¬é™ä½æ¨¡æ¿é›†æˆçš„éš¾åº¦ï¼Œå®ç°ä¸€é”®ç”Ÿæˆå¯è¿è¡Œç¨‹åº

## å¿«é€Ÿä½“éªŒ
åœ¨ä¸‹é¢è¿™ä¸ªcaseä¸­ï¼Œä½ å°†ä½“éªŒåˆ°å¦‚ä½•ä½¿ç”¨NULS ChainBoxå¿«é€Ÿæ„å»ºä¸€å¥—æä¾›åŠ å¯†é‚®ä»¶æœåŠ¡çš„åŒºå—é“¾åº”ç”¨

### 1 ç¯å¢ƒå‡†å¤‡

- linuxå†…æ ¸çš„æ“ä½œç³»ç»Ÿ
- å®‰è£… Git
- å®‰è£…Maven
- å®‰è£…JDK11

### 2 è·å–NULS ChainBox

æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤

```
git clone https://github.com/nuls-io/nuls-chainbox.git chainbox
```
### 3 æ„å»ºåŠ å¯†é‚®ä»¶æ¨¡å—
æ‰§è¡Œå‘½ä»¤è¿›å…¥exampleç›®å½•

```
cd example   #è¿›å…¥ç¤ºä¾‹æ–‡ä»¶å¤¹
```
æ‰§è¡Œå‘½ä»¤æ„å»ºæ¨¡å—

```
./package    #æ‰§è¡Œæ„å»ºè„šæœ¬ï¼ˆæ¨¡æ¿æä¾›ï¼‰
```

çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºåï¼Œè¯´æ˜æ„å»ºå®Œæˆ

```
============ PACKAGE FINISH ğŸºğŸºğŸºğŸ‰ğŸ‰ğŸ‰ ===============
```

æ„å»ºæˆåŠŸåä¼šåœ¨exampleä¸­ç”Ÿæˆouteræ–‡ä»¶å¤¹

> PS:å¦‚æœä½ æƒ³çŸ¥é“è¯¥æ¨¡å—æ˜¯å¦‚ä½•è®¾è®¡çš„ï¼Œè¯·æŸ¥çœ‹[åŠ å¯†é‚®ä»¶æ¨¡å—è®¾è®¡æ–‡æ¡£](./example/æ¨¡å—è®¾è®¡æ–‡æ¡£.md)

### 4 é›†æˆåŠ å¯†é‚®ä»¶æ¨¡å—
å›åˆ°chainboxæ ¹ç›®å½•

```
cd ..
```

æ‰§è¡Œå‘½ä»¤ï¼Œé›†æˆåŠ å¯†æ¨¡å—åˆ°NULS2.0è¿è¡Œç¯å¢ƒä¸­

```
./tools -p example
```
çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºåï¼Œè¯´æ˜é›†æˆæˆåŠŸ

```
============ PACKAGE FINISH ğŸºğŸºğŸºğŸ‰ğŸ‰ğŸ‰ ===============
```

å®Œæˆååœ¨chainboxç›®å½•ä¸‹ä¼šç”ŸæˆNULS-WALLETæ–‡ä»¶å¤¹ï¼Œæ­¤æ–‡ä»¶å¤¹åŒ…å«äº†é›†æˆäº†åŠ å¯†é‚®ä»¶æ¨¡å—çš„NULS2.0è¿è¡Œç¨‹åº

è‹¥åœ¨ä¸åŒæœºå™¨éƒ¨ç½²äº†å¤šä¸ªèŠ‚ç‚¹ï¼Œå»ºè®®ä¿®æ”¹NULS-WALLET/.default-config.ncfé…ç½®æ–‡ä»¶ä¸­çš„ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°

```
#æœ€å°é“¾æ¥èŠ‚ç‚¹æ•°,å½“é“¾æ¥åˆ°çš„ç½‘ç»œèŠ‚ç‚¹ä½äºæ­¤å‚æ•°æ—¶,ä¼šæŒç»­ç­‰å¾…
minNodeAmount=0
#ç§å­èŠ‚ç‚¹å‡ºå—åœ°å€
seedNodes=tNULSeBaMkrt4z9FYEkkR9D6choPVvQr94oYZp
```

### 5 å¯åŠ¨èŠ‚ç‚¹ç¨‹åº
é…ç½®å®Œæˆåï¼Œåœ¨NULS-WALLETç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤

```
./start-dev
```
çœ‹åˆ°ä»¥ä¸‹å†…å®¹è¯´æ˜æ¨¡å—æ­£åœ¨å¯åŠ¨ä¸­

```
LOG PATH    : ~/NULS-WALLET/Logs
DATA PATH   : ~/NULS-WALLET/data
CONFIG FILE : ~/NULS-WALLET/nuls.ncf
DEBUG       : 0
JAVA_HOME   : /Library/java/JavaVirtualMachines/jdk-11.0.2.jdk/Contents/Home
java version "11.0.2" 2019-01-15 LTS
Java(TM) SE Runtime Environment 18.9 (build 11.0.2+9-LTS)
Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.2+9-LTS, mixed mode)

====================
NULS-WALLET STARING
====================
```

å¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æ¨¡å—å¯åŠ¨æƒ…å†µ

```
./check-status 
```
çœ‹åˆ°ä»¥ä¸‹å†…å®¹è¡¨ç¤ºèŠ‚ç‚¹æ¨¡å—å·²å…¨éƒ¨å¯åŠ¨æˆåŠŸ

```
==================MODULE PROCESS====================
account PROCESS IS START
block PROCESS IS START
consensus PROCESS IS START
ledger PROCESS IS START
network PROCESS IS START
transaction PROCESS IS START
==================RPC REDAY MODULE==================
account RPC READY
block RPC READY
consensus RPC READY
ledger RPC READY
network RPC READY
transaction RPC READY
======================REDAY MODULE==================
account STATE IS READY
block STATE IS READY
consensus STATE IS READY
ledger STATE IS READY
network STATE IS READY
transaction STATE IS READY
================TRY RUNNING MODULE==================
account TRY RUNNING
block TRY RUNNING
consensus TRY RUNNING
ledger TRY RUNNING
network TRY RUNNING
transaction TRY RUNNING
===================RUNNING MODULE===================
account STATE IS RUNNING
block STATE IS RUNNING
consensus STATE IS RUNNING
ledger STATE IS RUNNING
network STATE IS RUNNING
transaction STATE IS RUNNING
==================NULS WALLET STATE=================
==========================
NULS WALLET IS RUNNING
==========================
```

### 7 å¯¼å…¥ç§å­èŠ‚ç‚¹å‡ºå—åœ°å€
ç°åœ¨ç§å­èŠ‚ç‚¹å·²ç»å¯åŠ¨ï¼Œæˆ‘ä»¬éœ€è¿›å…¥å‘½ä»¤è¡Œå¯¼å…¥é»˜è®¤çš„ç§å­å‡ºå—åœ°å€ï¼Œè®©èŠ‚ç‚¹å¼€å§‹å‡ºå—

é¦–å…ˆè¿›å…¥å‘½ä»¤è¡Œ

```
./cmd 
```
å¯¼å…¥å‡ºå—åœ°å€

```
nuls>>> import b54db432bba7e13a6c4a28f65b925b18e63bcb79143f7b894fa735d5d3d09db5 #é€šè¿‡ç§é’¥å¯¼å…¥ç§å­èŠ‚ç‚¹åœ°å€,æ­¤ç§é’¥ç”Ÿæˆçš„åœ°å€å¿…é¡»ä¸ç¬¬5æ­¥ç¬¬2æ¡çš„åœ°å€ç›¸åŒ
Please enter the password (password is between 8 and 20 inclusive of numbers and letters), If you do not want to set a password, return directly.
Enter your password:**********  #è®¾ç½®å¯¼å…¥åœ°å€çš„å¯†ç ï¼Œæ­¤å¯†ç ä¸ç¬¬4æ­¥ç¬¬3æ¡è®°å½•çš„å¯†ç å¿…é¡»ä¸€è‡´
Please confirm new password:********** #é‡å¤ä¸Šä¸€æ­¥è¾“å…¥çš„å¯†ç 
tNULSeBaMkrt4z9FYEkkR9D6choPVvQr94oYZp #å¯¼å…¥åœ°å€æˆåŠŸï¼ŒéªŒè¯æ­¤åœ°å€æ˜¯å¦ä¸ç¬¬4æ­¥ç¬¬2æ¡çš„é…ç½®é¡¹å®Œå…¨ä¸€è‡´
```

### 8 ä½¿ç”¨åŠ å¯†é‚®ä»¶

- å‡†å¤‡2ä¸ªè´¦æˆ·ï¼Œç”¨äºæµ‹è¯•å‘é€å’Œæ¥æ”¶é‚®ä»¶ï¼Œä¸‹æ–¹ä¸¤ä¸ªåœ°å€æ˜¯æµ‹è¯•ç¯å¢ƒåˆ›ä¸–å—ä¸­å®šä¹‰çš„åœ°å€ï¼Œè´¦æˆ·ä¸­æœ‰ä¸€å®šæ•°é‡çš„èµ„äº§ä¾›æµ‹è¯•ä½¿ç”¨ã€‚  

  ```
  nuls>>> import 477059f40708313626cccd26f276646e4466032cabceccbf571a7c46f954eb75
  Please enter the password (password is between 8 and 20 inclusive of numbers and letters), If you do not want to set a password, return directly.
  Enter your password:**********
  Please confirm new password:**********
  tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD
  
  nuls>>> import 8212e7ba23c8b52790c45b0514490356cd819db15d364cbe08659b5888339e78
  Please enter the password (password is between 8 and 20 inclusive of numbers and letters), If you do not want to set a password, return directly.
  Enter your password:**********
  Please confirm new password:**********
  tNULSeBaMrbMRiFAUeeAt6swb4xVBNyi81YL24
  ```

  

- è¿›å…¥NULS-WELLET/Modules/Nuls/mail-example/1.0.0ç›®å½•ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€mail-test.htmlï¼ˆè¿™æ˜¯ä¸€ä¸ªç®€å•çš„æµ‹è¯•é¡µé¢ï¼Œå¯ä»¥æµ‹è¯•ç»‘å®šé‚®ç®±åœ°å€ã€æ”¶å‘é‚®ä»¶ç­‰åŠŸèƒ½ï¼‰ï¼Œé¦–å…ˆç»™è´¦æˆ·ç»‘å®šé‚®ç®±åœ°å€

    ![](./document/images/bindmail.png)

    ç»™ä¸¤ä¸ªæµ‹è¯•è´¦æˆ·åˆ†åˆ«è®¾ç½®é‚®ç®±åœ°å€ï¼Œè¾“å…¥åˆšæ‰è®¾ç½®çš„æµ‹è¯•è´¦æˆ·å¯†ç ã€‚æäº¤æˆåŠŸåå°†è¿”å›æ­¤äº¤æ˜“çš„hashå€¼ã€‚æ­¤å¤„æˆ‘ä»¬ç”³è¯·é‚®ç®±åœ°å€åˆ†åˆ«ä¸ºasd@nuls.ioå’Œl24@nuls.ioã€‚è®¾ç½®å®Œæˆåéœ€è¦ç­‰å¾…10ç§’å·¦å³ç¡®è®¤åŒºå—ã€‚

- ç°åœ¨æˆ‘ä»¬æµ‹è¯•ç”¨asd@nuls.ioå‘l24@nuls.ioå‘é€é‚®ä»¶ã€‚è¾“å…¥æ”¶ä»¶äººé‚®ç®±åœ°å€ã€å‘ä»¶äººè´¦æˆ·åœ°å€ã€å‘ä»¶äººè´¦æˆ·å¯†ç ã€‚æäº¤æˆåŠŸåå°†è¿”å›æ­¤äº¤æ˜“çš„hashå€¼ã€‚

    ![](./document/images/sendmail.png)

- ç­‰å¾…å¤§çº¦10ç§’é’Ÿåï¼ˆç¡®ä¿äº¤æ˜“å·²ç»ç¡®è®¤ï¼‰ï¼Œé€šè¿‡å‘é€é‚®ä»¶çš„hashå€¼æŸ¥çœ‹é‚®ä»¶å†…å®¹ï¼Œåªæœ‰å‘ä»¶äººå’Œæ”¶ä»¶äººæ‰èƒ½æŸ¥çœ‹ã€‚
  ![](./document/images/viewmail.png)

  ```
  {
      "senderMailAddress": "asd@nuls.io",   //å‘ä»¶äººé‚®ç®±åœ°å€
      "receiverMailAddress": "24@nuls.io",  //æ”¶ä»¶äººé‚®ç®±åœ°å€
      "title": "this is title",             //é‚®ä»¶æ ‡é¢˜
      "content": "NULS 666.",               //é‚®ä»¶å†…å®¹
      "sender": "tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD",   //å‘ä»¶äººè´¦æˆ·åœ°å€
      "date": 1561365228904                 //å‘ä»¶æ—¶é—´æˆ³ï¼ˆ1970å¹´1æœˆ1æ—¥åˆ°å½“å‰çš„æ¯«ç§’æ•°ï¼‰
  }
  ```
  
## ChainBoxä½¿ç”¨æŒ‡å—
### ç›®å½•ç»“æ„
#### tools
ChainBoxä½¿ç”¨å…¥å£ï¼Œæä¾›è·å–ç¨‹åºã€é›†æˆæ‰“åŒ…ç­‰æ“ä½œã€‚[å‘½ä»¤å‚æ•°æ–‡æ¡£](#cmd-doc)ã€‚
#### document
æ–‡æ¡£åˆ—è¡¨ã€‚
#### example
åŸºäºjavaæ¨¡å—æ¨¡æ¿å¼€å‘çš„ä¸€ä¸ªåŠ å¯†é‚®ä»¶çš„ç¤ºä¾‹æ¨¡å—ç¨‹åºæºç ã€‚
#### rpc-debug-tool
åŸºç¡€æ¨¡å—rpcæ¥å£è°ƒè¯•å·¥å…·ã€‚

### è·å–NULS2.0è¿è¡Œç¯å¢ƒ
NULS2.0è¿è¡Œç¯å¢ƒåŒ…å«ä¸€å¥—æœ€åŸºç¡€çš„åŒºå—é“¾ç¨‹åºï¼Œé‡Œé¢åŒ…å«äº†è´¦æˆ·ã€è´¦æœ¬ã€åŒºå—ã€ç½‘ç»œã€äº¤æ˜“ã€å…±è¯†ï¼ˆpocï¼‰6å¤§æ ¸å¿ƒæ¨¡å—ã€‚è¿è¡ŒNULS2.0åŸºç¡€è¿è¡Œç¯å¢ƒä½ å¯ä»¥å¾—åˆ°åŒ…å«è´¦æˆ·æ¨¡å‹ã€è½¬è´¦äº¤æ˜“ã€POCå…±è¯†æ¿€åŠ±ç­‰åŒºå—é“¾åº•å±‚çš„æ ¸å¿ƒåŠŸèƒ½ã€‚å¦‚æœåªæƒ³å‘ä¸€æ¡ç®€å•çš„è½¬è´¦äº¤æ˜“çš„é“¾ï¼Œé€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶å°±å¯ä»¥å®Œæˆï¼ˆ[å®Œæ•´çš„é…ç½®åˆ—è¡¨](https://github.com/nuls-io/nuls-v2/blob/develop/useguide.md#nulsncf-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6)ï¼‰ã€‚ä½ å¯ä»¥åœ¨åŸºç¡€ç¯å¢ƒä¸­é›†æˆè‡ªå·±çš„ä¸šåŠ¡æ¨¡å—ï¼Œé€šè¿‡æ‰©å±•ä¸€ä¸ªæ–°çš„äº¤æ˜“ç±»å‹çš„æ–¹å¼å®Œæˆè‡ªå·±çš„ä¸šåŠ¡ï¼Œåœ¨ä¸‹é¢ä¸€ä¸ªæ®µè½ä¸­æˆ‘ä¼šè¯¦ç»†ä»‹ç»å¦‚ä½•æ„å»ºè‡ªå·±çš„ä¸šåŠ¡ã€‚

ä½¿ç”¨toolsè„šæœ¬è·å–NULS2.0è¿è¡Œç¯å¢ƒ

```
./tools -p
```
è„šæœ¬ä¼šé¦–å…ˆæ£€æŸ¥å½“å‰ç¯å¢ƒï¼Œç„¶åä»æ‹‰å–NULS2.0åœ¨githubä»“åº“é‡Œçš„ä»£ç ï¼Œæ‰§è¡Œpackageå®ŒæˆNULS2.0ç¼–è¯‘æ‰“åŒ…ï¼Œå°†å¯è¿è¡Œç¨‹åºè¾“å‡ºåˆ°./NULS-WALLET-RUNTIMEç›®å½•ä¸­ã€‚
å½“çœ‹åˆ°ä»¥ä¸‹å†…å®¹æ—¶è¡¨ç¤ºæ‰“åŒ…å®Œæˆã€‚

```
============ ~/nuls-engine/NULS-WALLET-RUNTIME PACKAGE FINISH ğŸºğŸºğŸºğŸ‰ğŸ‰ğŸ‰ ===============
```
#### NULS-WALLET-RUNTIMEç›®å½•ç»“æ„
##### start-dev
å¯åŠ¨èŠ‚ç‚¹
##### stop-dev
åœæ­¢èŠ‚ç‚¹
##### check-status 
æ£€æŸ¥å„ä¸ªæ¨¡å—è¿è¡ŒçŠ¶æ€
##### cmd
å‘½ä»¤è¡Œå¯åŠ¨è„šæœ¬
##### create-address
åˆ›å»ºåœ°å€å·¥å…·
##### nuls.ncf
é…ç½®æ–‡ä»¶ï¼ˆé¦–æ¬¡è¿è¡Œstart-devè„šæœ¬ååˆ›å»ºï¼‰
##### æ›´å¤šä½¿ç”¨æ–¹æ³•å‚è€ƒï¼ˆ[NULS2.0é’±åŒ…ä½¿ç”¨æ‰‹å†Œ](https://github.com/nuls-io/nuls-v2/blob/develop/useguide.md)ï¼‰
### å¦‚ä½•å¼€å‘è‡ªå·±çš„æ¨¡å—
NULS2.0æ˜¯ç”¨JAVAè¯­è¨€ç¼–å†™çš„åˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„çš„ç¨‹åºï¼Œæ•´ä¸ªèŠ‚ç‚¹ç¨‹åºç”±å¤šä¸ªæ¨¡å—ç»„æˆï¼Œæ¯ä¸ªæ¨¡å—ä¹‹é—´é€šè¿‡websocketåè®®é€šä¿¡ã€‚NULS2.0å®šä¹‰äº†ä¸€å¥—æ ‡å‡†çš„[æ¨¡å—é€šä¿¡åè®®](https://github.com/nuls-io/nuls-v2-docs/blob/master/design-zh-CHS/r.rpc-tool-websocket%E8%AE%BE%E8%AE%A1v1.3.md)ï¼Œå¯ä»¥é€šè¿‡å„ç§å¼€å‘è¯­è¨€å®ç°æ­¤æ ‡å‡†åè®®ä¸å…¶ä»–æ¨¡å—é€šä¿¡ï¼Œè¿›è€Œå®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ã€‚æ‰©å±•è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ä¸»è¦æ˜¯é€šè¿‡æ‰©å±•æ–°çš„äº¤æ˜“ç±»å‹å®ç°ï¼Œåœ¨äº¤æ˜“çš„txDataä¸­å­˜å‚¨è‡ªå·±çš„ä¸šåŠ¡æ•°æ®ï¼ŒtxDataå°†è·Ÿéšäº¤æ˜“å­˜å‚¨åœ¨é“¾ä¸Šã€‚
#### åˆ›å»ºäº¤æ˜“æµç¨‹
![èŠ‚ç‚¹åˆ›å»ºäº¤æ˜“](./document/images/createtx.png)
#### å¤„ç†ç½‘ç»œäº¤æ˜“æµç¨‹
![å¤„ç†ç½‘ç»œå¹¿æ’­äº¤æ˜“](./document/images/handnetworktx.png)

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ‰©å±•ä¸€ä¸ªæ–°çš„ä¸šåŠ¡æ¨¡å—ä¸»è¦éœ€è¦åš4ä»¶äº‹
1. åœ¨äº¤æ˜“æ¨¡å—æ³¨å†Œè‡ªå·±çš„äº¤æ˜“ç±»å‹ã€‚
2. ç»„è£…äº¤æ˜“æ•°æ®ï¼Œè°ƒç”¨äº¤æ˜“æ¨¡å—åˆ›å»ºæ–°çš„äº¤æ˜“ã€‚
3. éªŒè¯äº¤æ˜“ä¸­çš„ä¸šåŠ¡æ•°æ®æ˜¯å¦åˆæ³•ã€‚
4. å°†äº¤æ˜“ä¸­çš„ä¸šåŠ¡æ•°æ®ä¿å­˜åˆ°èŠ‚ç‚¹æ•°æ®åº“ä¸­ã€‚

å½“ç„¶é™¤äº†ä¸Šé¢4æ­¥ï¼Œè¿˜éœ€è¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚å¯¹ä¸šåŠ¡æ•°æ®è¿›è¡Œä½¿ç”¨ã€‚ä¸‹é¢æˆ‘å°±å¯¹ä»¥ä¸Š4æ­¥è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚

åœ¨ç³»ç»Ÿä¸­æ¯ç§äº¤æ˜“éƒ½éœ€è¦å®šä¹‰ä¸€ä¸ªæ•´æ•°ç±»å‹çš„å”¯ä¸€çš„äº¤æ˜“ç±»å‹ï¼ˆæ‰©å±•çš„äº¤æ˜“é€šå¸¸ç”¨200ä»¥ä¸Šçš„å€¼ï¼‰ï¼Œç”¨äºåŒºåˆ†å¤„ç†çš„äº¤æ˜“çš„å›è°ƒå‡½æ•°ã€‚é€šå¸¸åº”è¯¥åœ¨æ¨¡å—å¯åŠ¨çš„æ—¶å€™è°ƒç”¨äº¤æ˜“æ¨¡å—æä¾›çš„æ³¨å†Œäº¤æ˜“æ¥å£ï¼ˆè¯·æŸ¥çœ‹äº¤æ˜“æ¨¡å—çš„RPCæ¥å£æ–‡æ¡£ï¼‰ã€‚å½“äº¤æ˜“æ¨¡å—æ‹¿åˆ°ä¸€æ¡å¾…å¤„ç†çš„äº¤æ˜“æ—¶ï¼Œä¼šæ ¹æ®äº¤æ˜“ç±»å‹è·¯ç”±åˆ°æ³¨å†Œçš„éªŒè¯å‡½æ•°å¯¹äº¤æ˜“ä¸šåŠ¡æ•°æ®çš„åˆæ³•æ€§è¿›è¡Œæ ¡éªŒã€‚é™¤äº†éªŒè¯ä»¥å¤–è¿˜æœ‰commitTx(ä¿å­˜äº¤æ˜“ä¸šåŠ¡æ•°æ®ï¼‰ã€rollbackTxï¼ˆå›æ»šäº¤æ˜“çš„ä¸šåŠ¡æ•°æ®ï¼‰ä¸¤ä¸ªå‡½æ•°ã€‚

é€šå¸¸ç”±ä¸šåŠ¡æ¨¡å—ç»„è£…è‡ªå·±æ‰©å±•çš„äº¤æ˜“ç±»å‹ï¼Œä¸€æ¡åˆæ³•çš„äº¤æ˜“ä¸­åŒ…æ‹¬äº¤æ˜“ç±»å‹ã€æ—¶é—´æˆ³ã€CoinDataã€txDataã€å¤‡æ³¨ã€ç­¾åå‡ ä¸ªéƒ¨åˆ†ã€‚å…¶ä¸­CoinDataä¸­åŒ…å«äº†è½¬è´¦æ•°æ®ï¼Œè½¬å‡ºè´¦æˆ·ã€è½¬å…¥è´¦æˆ·ã€è½¬è´¦é‡‘é¢ã€èµ„äº§ä¿¡æ¯ç­‰ã€‚è€ŒtxDataä¸­ä¸»è¦ç”¨äº†ä¿å­˜ä¸šåŠ¡æ•°æ®ï¼Œåº•å±‚ä¸ä¼šå¯¹txDataå­—æ®µè¿›è¡ŒéªŒè¯å’Œå¤„ç†ï¼Œä¸šåŠ¡æ¨¡å—æ ¹æ®ä¸šåŠ¡è®¾è®¡åœ¨txDataä¸­å­˜å‚¨è‡ªå·±çš„ä¸šåŠ¡æ•°æ®ã€‚ç­¾åå­—æ®µé€šè¿‡æ¤­åœ†å½¢æ›²çº¿ç®—æ³•å¯¹æ‰€æœ‰äº¤æ˜“æ•°æ®è¿›è¡Œç­¾åï¼Œç¡®ä¿åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®ä¸è¢«ä¸²æ”¹ã€‚ç»„è£…å®Œæˆåï¼Œè°ƒç”¨äº¤æ˜“æ¨¡å—æ¥å£åˆ›å»ºäº¤æ˜“ã€‚

äº¤æ˜“æ¨¡å—ä¼šé€šè¿‡å½“å‰èŠ‚ç‚¹è‡ªå·±åˆ›å»ºè·å¾—äº¤æ˜“ï¼Œä¹Ÿä¼šé€šè¿‡ç½‘ç»œæ¨¡å—æ¥æ”¶å…¶ä»–èŠ‚ç‚¹å¹¿æ’­è¿‡æ¥çš„äº¤æ˜“ã€‚äº¤æ˜“æ¨¡å—æ‹¿åˆ°äº¤æ˜“åï¼Œé¦–å…ˆä¼šå¯¹äº¤æ˜“æ•°æ®çš„å‚æ•°æ˜¯å¦åˆæ³•ï¼Œç„¶åæ£€æŸ¥è´¦æˆ·ä½™é¢æ˜¯å¦è¶³å¤Ÿæ”¯ä»˜äº¤æ˜“æ‰‹ç»­è´¹ï¼Œç„¶åéªŒè¯è´¦æˆ·çš„nonceå€¼(é€šè¿‡æ§åˆ¶äº¤æ˜“é¡ºåºæ¥ä¿è¯ä½™é¢ä¸è¢«é‡å¤ä½¿ç”¨çš„ä¸€ç§ç®—æ³•ï¼‰æ˜¯å¦åˆæ³•ã€‚éªŒè¯é€šè¿‡åæ ¹æ®äº¤æ˜“ç±»å‹æ‰¾åˆ°ä¸šåŠ¡éªŒè¯çš„å›è°ƒå‡½æ•°ï¼Œå¯¹äº¤æ˜“è¿›è¡Œä¸šåŠ¡éªŒè¯ã€‚

æœ€åå½“äº¤æ˜“æ‰“å…¥åŒºå—ï¼Œå¹¶ä¸”åŒºå—å·²ç»ç¡®è®¤åï¼Œå°†åœ¨é€šè¿‡äº¤æ˜“ç±»å‹æ‰¾åˆ°å­˜å‚¨ä¸šåŠ¡æ•°æ®çš„å›è°ƒå‡½æ•°ï¼Œé€šçŸ¥ä¸šåŠ¡æ¨¡å—å¯ä»¥ä¿æŒä¸šåŠ¡æ•°æ®å¯¼èŠ‚ç‚¹æœ¬åœ°ã€‚æœ‰äº›æƒ…å†µå¯èƒ½ä¼šå‡ºç°åŒºå—å›æ»šã€‚å½“åŒºå—å‘ç”Ÿå›æ»šæ—¶ï¼Œä¹Ÿä¼šé€šè¿‡äº¤æ˜“ç±»å‹åŒ¹é…åˆ°å¯¹åº”çš„äº¤æ˜“å›æ»šå›è°ƒå‡½æ•°ï¼Œå¯¹ä¸šåŠ¡æ•°æ®è¿›è¡Œå›æ»šå¤„ç†ã€‚

ä»¥ä¸Šå°±æ˜¯æ‰©å±•ä¸€ç§äº¤æ˜“ç±»å‹éœ€è¦å®Œæˆçš„å‡ ä¸ªæ ¸å¿ƒæ­¥éª¤ã€‚éªŒè¯äº¤æ˜“ã€ä¿å­˜ä¸šåŠ¡æ•°æ®ã€å›æ»šä¸šåŠ¡æ•°æ®3ä¸ªæ¥å£ç”±ä¸šåŠ¡æ¨¡å—å®ç°ï¼ŒæŸ¥çœ‹å…·ä½“[æ¥å£åè®®](#registerTx)ã€‚
### ä¸å…¶ä»–æ¨¡å—é€šä¿¡
NULS2.0é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œæ¨¡å—ä¹‹é—´ä½¿ç”¨[websocket](https://zh.wikipedia.org/wiki/WebSocket)é€šä¿¡ã€‚æ‰€æœ‰æ¨¡å—çš„é“¾æ¥é€šè¿‡Nulstaræ²»ç†ï¼Œæµç¨‹å¦‚ä¸‹ï¼š

![](./document/images/pic01.jpeg)

æ‰€æœ‰æ¨¡å—ç”±ServiceManagerå¯åŠ¨ï¼Œå¯åŠ¨åä¸»åŠ¨ä¸ServiceManageræ¨¡å—å»ºç«‹è¿æ¥ï¼ŒæŒ‰åè®®çº¦å®šå®Œæˆæ¡æ‰‹,æ¡æ‰‹æˆåŠŸåå‘ServiceManageræ³¨å†Œï¼Œæ³¨å†Œçš„ç›®çš„ä¸»è¦æ˜¯å‘Šè¯‰ServiceManagerè‡ªå·±çš„è¿æ¥æ–¹å¼ã€æä¾›çš„æ¥å£åè®®ã€éœ€è¦ä¾èµ–å“ªäº›æ¨¡å—ã€‚
#### å»ºç«‹è¿æ¥
ä½¿ç”¨æ ‡å‡†çš„websocketåè®®å»ºç«‹è¿æ¥ï¼Œè¿æ¥æ–¹å¼åœ¨æ­¤ä¸å†èµ˜è¿°ã€‚è¿æ¥å»ºç«‹å®Œæˆåï¼Œå°±å¯ä»¥å‘å¯¹æ–¹å‘é€æ•°æ®åŒ…ï¼ˆæ¥å£è¯·æ±‚ï¼‰å’Œæ¥æ”¶å¯¹æ–¹çš„æ•°æ®åŒ…ã€‚æ³¨æ„ï¼šæ‰€æœ‰çš„è¯·æ±‚éƒ½æ˜¯å¼‚æ­¥è¯·æ±‚ï¼ŒéåŒæ­¥é˜»å¡ã€‚
#### ä¸ServiceManageræ¡æ‰‹
ä¸ServiceManagerå»ºç«‹è¿æ¥åï¼Œéœ€è¦é¦–å…ˆå‘é€ä¸€ä¸ªNegotiateConnectionå¯¹è±¡ï¼Œåªæœ‰åœ¨åå•†æˆåŠŸæ—¶ï¼ŒæœåŠ¡æ‰å¯ä»¥å¤„ç†å…¶ä»–è¯·æ±‚ï¼Œå¦åˆ™åº”è¯¥æ”¶åˆ°çŠ¶æ€è®¾ç½®ä¸º0ï¼ˆå¤±è´¥ï¼‰çš„NegotiateConnectionResponseå¯¹è±¡å¹¶ç«‹å³æ–­å¼€è¿æ¥ã€‚
å®ƒç”±ä¸¤ä¸ªå­—æ®µç»„æˆï¼š

- CompressionAlgorithmï¼ˆé»˜è®¤å€¼ï¼šzlibï¼‰ï¼šä¸€ä¸ªStringï¼Œè¡¨ç¤ºå¦‚æœCompressionRateå¤§äº0ï¼Œå°†ç”¨äºæ¥æ”¶å’Œå‘é€æ¶ˆæ¯çš„ç®—æ³•ã€‚é»˜è®¤ä¸ºzlibï¼Œå¤§å¤šæ•°å¼€å‘è¯­è¨€ä¸­éƒ½æœ‰æ”¯æŒçš„åº“ã€‚
- CompressionRateï¼š0åˆ°9ä¹‹é—´çš„ä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºå»ºç«‹åº”ä¸ºæ­¤è¿æ¥å‘é€å’Œæ¥æ”¶æ¶ˆæ¯çš„å‹ç¼©çº§åˆ«ã€‚ 0è¡¨ç¤ºæ²¡æœ‰å‹ç¼©ï¼Œè€Œ9è¡¨ç¤ºæœ€å¤§å‹ç¼©

ç¤ºä¾‹ï¼š

```json
    {
        "MessageID": "15622130397455",
        "Timestamp": "1562213039745",
        "TimeZone": "9",
        "MessageType": "NegotiateConnection",
        "MessageData": {
            "Abbreviation": "ledger",   #æ¨¡å—name
            "ProtocolVersion": "0.1",   #åè®®ç‰ˆæœ¬å·
            "CompressionAlgorithm": "zlib",
            "CompressionRate": "0"
        }
    }
```
æ¡æ‰‹æˆåŠŸåï¼ŒServiceManagerå‘é€NegotiateConnectionResponseå¯¹è±¡ç»™ä¸šåŠ¡æ¨¡å—ã€‚å®ƒç”±ä¸¤ä¸ªå­—æ®µç»„æˆï¼š

- NegotiationStatusï¼šæ— ç¬¦å·çš„å°æ•´æ•°å€¼ï¼Œå¦‚æœåå•†å¤±è´¥åˆ™ä¸º0ï¼Œå¦‚æœæˆåŠŸåˆ™ä¸º1
- NegotiationCommentï¼šä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼Œç”¨äºæè¿°æ‹’ç»è¿æ¥æ—¶å‡ºç°äº†ä»€ä¹ˆé—®é¢˜ã€‚

ç¤ºä¾‹ï¼š

```json
{
    "MessageID": "156221303974612033",
    "Timestamp": "1562213039759",
    "TimeZone": "9",
    "MessageType": "NegotiateConnectionResponse",
    "MessageData": {
        "RequestID": "15622130397455",
        "NegotiationStatus": "1",
        "NegotiationComment": "Connection true!"
    }
}
```
#### registerAPI(æ³¨å†Œæ¨¡å—ï¼‰
ä¸ServiceManageræ¡æ‰‹æˆåŠŸåï¼Œå‘ServiceManagerå‘é€RegisterAPIè¯·æ±‚ï¼Œå®Œæˆæ³¨å†Œã€‚ServiceManagerå°†é€šè¿‡æ­¤æ¬¡è¯·æ±‚è·å–æ¨¡å—çš„è¿æ¥ä¿¡æ¯å’Œæ¥å£æ–¹æ³•ï¼Œå¹¶é€šè¿‡åˆ†ææ­¤æ¨¡å—çš„ä¾èµ–æ¨¡å—æ˜¯å¦å­˜åœ¨æ¥å†³å®šæ­¤æ¨¡å—æ˜¯å¦æ»¡è¶³æ­£å¸¸å·¥ä½œçš„æ¡ä»¶ã€‚
ç¤ºä¾‹ï¼š

```
{
    "MessageID": "15622130392482",
    "Timestamp": "1562213039248",
    "TimeZone": "9",
    "MessageType": "Request",
    "MessageData": {
        "RequestAck": "0",
        "SubscriptionEventCounter": "0",
        "SubscriptionPeriod": "0",
        "SubscriptionRange": "0",
        "ResponseMaxSize": "0",
        "RequestMethods": {
            "RegisterAPI": {
                "Methods": [
                    {
                        "MethodName": "getAssetsById",
                        "MethodDescription": "æ¸…é™¤æ‰€æœ‰è´¦æˆ·æœªç¡®è®¤äº¤æ˜“",
                        "MethodMinEvent": "0",
                        "MethodMinPeriod": "0",
                        "MethodScope": "public",
                        "Parameters": [
                            {
                                "ParameterName": "chainId",
                                "ParameterType": "",
                                "ParameterValidRange": "[1-65535]",
                                "ParameterValidRegExp": ""
                            },
                            {
                                "ParameterName": "assetIds",
                                "ParameterType": "",
                                "ParameterValidRange": "",
                                "ParameterValidRegExp": ""
                            }
                        ]
                    }
                ],
                "Dependencies": {
                    "block": "1.0",
                    "network": "1.0"
                },
                "ConnectionInformation": {
                    "IP": "192.168.0.197",
                    "Port": "17880"
                },
                "ModuleDomain": "Nuls",
                "ModuleRoles": {
                    "ledger": [
                        "1.0"
                    ]
                },
                "ModuleVersion": "1.0",
                "Abbreviation": "ledger",
                "ModuleName": "ledger"
            }
        }
    }
}
```
ServiceManageråˆ¤æ–­ä¾èµ–éƒ½å·²å¯åŠ¨åï¼Œä¼šè¿”å›ä¸€ä¸ªResponseï¼Œæ•°æ®ä¸­åŒ…å«äº†ä¾èµ–çš„æ¨¡å—çš„é“¾æ¥æ–¹å¼ã€‚
ç¤ºä¾‹:

```
{
    "MessageID": "1562213039283455",
    "Timestamp": "1562213039283",
    "TimeZone": "9",
    "MessageType": "Response",
    "MessageData": {
        "RequestID": "15622130392482",
        "ResponseProcessingTime": "2",
        "ResponseStatus": 0,
        "ResponseComment": "success",
        "ResponseMaxSize": "0",
        "ResponseData": {
            "RegisterAPI": {
                "Dependencies": {
                    "consensus": {
                        "IP": "192.168.0.197",
                        "Port": "18735"
                    },
                    "ledger": {
                        "IP": "192.168.0.197",
                        "Port": "17880"
                    },
                    "nuls-module-explorer": {
                        "IP": "192.168.0.197",
                        "Port": "10130"
                    },
                    "kernel": {
                        "IP": "0.0.0.0",
                        "Port": "7771"
                    },
                    "block": {
                        "IP": "192.168.0.197",
                        "Port": "13437"
                    },
                    "transaction": {
                        "IP": "192.168.0.197",
                        "Port": "14026"
                    },
                    "account": {
                        "IP": "192.168.0.197",
                        "Port": "15121"
                    },
                    "network": {
                        "IP": "192.168.0.197",
                        "Port": "15481"
                    }
                }
            }
        },
        "ResponseErrorCode": null
    }
}
```
æ¨¡å—è·å–åˆ°ä¾èµ–æ¨¡å—çš„é“¾æ¥æ–¹å¼åå°±å¯ä»¥ä¸æ­¤å…¶ä»–æ¨¡å—å»ºç«‹è¿æ¥å‘é€æ¥å£è¯·æ±‚ã€‚
#### è°ƒç”¨å…¶ä»–æ¨¡å—æ¥å£
åœ¨è°ƒç”¨å…¶ä»–æ¨¡å—çš„æ¥å£å‰ä¹Ÿéœ€è¦å®Œæˆå»ºç«‹websocketè¿æ¥ã€ä¸æ¨¡å—æ¡æ‰‹çš„æ“ä½œï¼Œæ¡æ‰‹å®Œæˆåå°±å¯ä»¥å‘æ¨¡å—å‘é€Requestå¯¹è±¡ã€‚
ç¤ºä¾‹:

```
{
    "MessageID": "156222086356134",
    "Timestamp": "1562220863561",
    "TimeZone": "9",
    "MessageType": "Request",
    "MessageData": {
        "RequestAck": "0",
        "SubscriptionEventCounter": "0",
        "SubscriptionPeriod": "0",
        "SubscriptionRange": "0",
        "ResponseMaxSize": "0",
        "RequestMethods": {
            "ac_createAccount": {
                "chainId": 2,
                "count": 1,
                "password": "nuls123456"
            }
        }
    }
}
```
å…¶ä¸­RequestMethodsçš„å†…å®¹ä¸ºè¯·æ±‚çš„å‚æ•°ï¼Œå¤–å±‚æ•°æ®ä¸ºåè®®å±‚ã€‚ä¸šåŠ¡æ¨¡å—å¤„ç†å®Œæˆåï¼Œä¼šå‘é€Responseå¯¹è±¡ï¼Œè¿”å›å¤„ç†ç»“æœå’Œç»“æœæ•°æ®ã€‚
ç¤ºä¾‹ï¼š

```
{
    "MessageID": "156222086367037",
    "Timestamp": "1562220863664",
    "TimeZone": "9",
    "MessageType": "Response",
    "MessageData": {
        "RequestID": "156222086356134",
        "ResponseProcessingTime": "107",
        "ResponseStatus": 0,
        "ResponseComment": "success",
        "ResponseMaxSize": "0",
        "ResponseData": {
            "ac_createAccount": {
                "list": [
                    "tNULSeBaMkef3L6EsMcigwT1C1uebzfsj63jd3"
                ]
            }
        },
        "ResponseErrorCode": null
    }
}
```
#### å‚è€ƒæ–‡æ¡£ï¼š
* [Websocket-Toolè®¾è®¡æ–‡æ¡£](https://github.com/nuls-io/nuls-v2-docs/blob/master/design-zh-CHS/r.rpc-tool-websocket%E8%AE%BE%E8%AE%A1v1.3.md)
* [Nulstar Module Specification](https://github.com/nuls-io/Nulstar/blob/master/Documents/Nulstar%20-%20Documentation%20-%20Module%20Specification.pdf)
* [åŸºç¡€æ¨¡å—æ¥å£æ–‡æ¡£](#doclist)

### è·å–å„ç§å¼€å‘è¯­è¨€çš„æ¨¡å—å¼€å‘æ¨¡æ¿
ç†è®ºä¸Šåªè¦é€šè¿‡websocketä¸æ¨¡å—å»ºç«‹è¿æ¥ï¼Œç„¶åæŒ‰ç…§çº¦å®šçš„åè®®ä¸æ¨¡å—è¿›è¡Œä¿¡æ¯äº¤æ¢å°±å¯ä»¥å®ç°ä¸šåŠ¡æ¨¡å—çš„æ‰©å±•ã€‚ä½†æ˜¯è¿™æ ·ä»å¤´é€ è½®å­çš„æ–¹å¼æ•ˆç‡æ¯”è¾ƒä½ï¼Œé—¨æ§›ä¹Ÿæ¯”è¾ƒé«˜ï¼Œä¸ºäº†é™ä½æ¨¡å—å¼€å‘çš„éš¾åº¦ï¼Œæˆ‘ä»¬å°†ä¸ºå„ç§è¯­è¨€æä¾›å¿«é€Ÿå¼€å§‹çš„æ¨¡æ¿(ç›®å‰åªæä¾›äº†javaï¼‰ï¼Œå¼€å‘äººå‘˜åªéœ€è¦åœ¨æ¨¡æ¿ä¸­çš„æŒ‡å®šä½ç½®æ’å…¥å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ä»£ç å°±å¯ä»¥å®Œæˆæ‰©å±•æ¨¡å—çš„å¼€å‘ã€‚

é€šè¿‡toolsè„šæœ¬å¯ä»¥éå¸¸ç®€å•çš„è·å–åˆ°æŒ‡å®šçš„è¯­è¨€çš„æ¨¡å—å¼€å‘æ¨¡æ¿ã€‚

```
tools -t java 
```
æ‰§è¡Œå®Œæˆåï¼Œä¼šåœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªnuls-module-javaçš„æ–‡ä»¶å¤¹ï¼Œå¯¼å…¥å¸¸ç”¨çš„å¼€å‘å·¥å…·å°±å¯ä»¥å¼€å§‹å¼€å‘ä¸šåŠ¡äº†ã€‚æ¯ä¸ªæ¨¡æ¿é‡Œéƒ½ä¼šæœ‰å¯¹åº”çš„ä½¿ç”¨æ–‡æ¡£ã€‚
### æ¨¡å—è°ƒè¯•æ–¹æ³•
åœ¨æ¨¡å—å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦ä¸åŸºç¡€æ¨¡å—è¿›è¡Œè”è°ƒï¼Œè·å–åˆ°NULS2.0è¿è¡Œç¯å¢ƒåï¼Œæ‰§è¡Œstart-mykernelè„šæœ¬å¯åŠ¨NULS2.0åŸºç¡€æ¨¡å—ï¼Œç„¶ååœ¨ä¸šåŠ¡æ¨¡å—ä¸­å‘ws://127.0.0.1:7771åœ°å€è¿›è¡Œæ³¨å†Œï¼Œæ³¨å†Œåè®®ã€‚å®Œæˆæ³¨å†Œåï¼Œå°±å¯ä»¥è·å–åˆ°æ‰€ä¾èµ–çš„å„ä¸ªæ¨¡å—çš„é€šä¿¡åœ°å€ï¼Œè°ƒç”¨æ¨¡å—çš„æ¥å£ã€‚
### å°†ä¸šåŠ¡æ¨¡å—é›†æˆåˆ°NULS2.0è¿è¡Œç¯å¢ƒä¸­
ä¸šåŠ¡æ¨¡å—å¼€å‘å®Œæˆåï¼Œéœ€è¦å°†ä¸šåŠ¡æ¨¡å—é›†æˆåˆ°NULS2.0è¿è¡Œç¯å¢ƒä¸­ï¼Œç„¶åå°†è¾“å‡ºçš„ç¨‹åºéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­æˆ–è¾“å‡ºåˆ°å¤–éƒ¨èŠ‚ç‚¹è¿è¡Œã€‚ä½¿ç”¨toolsè„šæœ¬å®Œæˆé›†æˆéœ€è¦æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªçº¦å®šã€‚
1. æ‰“åŒ…å¥½çš„å¯è¿è¡Œç¨‹åºåº”è¯¥æ”¾åœ¨æ¨¡å—å¼€å‘ç›®å½•ä¸‹çš„outerç›®å½•ä¸‹ã€‚
2. outerç›®å½•ä¸­å¿…é¡»æœ‰ä¸€ä¸ªæ–‡ä»¶åä¸ºModule.ncfçš„é…ç½®æ–‡ä»¶ï¼ˆæ³¨æ„Må¤§å†™ï¼‰ã€‚æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼ˆä»¥javaä¸ºä¾‹ï¼‰

    ```
    [Core]
    Language=JAVA      # æ³¨æ˜å¼€å‘è¯­è¨€
    Managed=1          # 1è¡¨ç¤ºæ¨¡å—è·ŸéšèŠ‚ç‚¹ç¨‹åºä¸€èµ·å¯åŠ¨ï¼Œ0è¡¨ç¤ºæ‰‹åŠ¨å¯åŠ¨
    
    [Libraries]
    JRE=11.0.2         # æ¨¡å—è¿è¥ç¯å¢ƒç‰ˆæœ¬
    
    [Script]
    Scripted=1         # æ˜¯å¦ä½¿ç”¨è„šæœ¬å¯åŠ¨  1è¡¨ç¤ºæ˜¯
    StartScript=start  # å¯åŠ¨æ¨¡å—è„šæœ¬(startå¿…é¡»åœ¨outerç›®å½•ä¸‹)
    StopScript=stop    # åœæ­¢æ¨¡å—è„šæœ¬(stopå¿…é¡»åœ¨outerç›®å½•ä¸‹)
    
    ```
3. å¯ä»¥é€šè¿‡2ä¸­é…ç½®çš„è„šæœ¬å¯åŠ¨æ¨¡å—å’Œåœæ­¢æ¨¡å—ã€‚
#### æ¨¡å—å¼€å‘æ¨¡æ¿ä¸­å·²å®Œæˆä»¥ä¸Šçº¦å®šã€‚

## é™„å½•
## <span id="cmd-doc">toolsè„šæœ¬ä½¿ç”¨æ‰‹å†Œ</span>
### è·å–NULS2.0è¿è¡Œç¯å¢ƒ
#### å‘½ä»¤ï¼štools -n
#### å‚æ•°åˆ—è¡¨
æ— 
#### ç¤ºä¾‹
```
tools -n
```
### è·å–æŒ‡å®šè¯­è¨€æ¨¡å—å¼€å‘æ¨¡æ¿
#### å‘½ä»¤:tools -t &lt;language> [out folder]
#### å‚æ•°åˆ—è¡¨
| å‚æ•° | è¯´æ˜ |
| --- | --- |
| &lt;language> | è¯­è¨€æ¨¡æ¿åç§° |
| [out folder] | è¾“å‡ºçš„æ–‡ä»¶å¤¹å |
#### ç¤ºä¾‹
```
tools -t java demo
```
### æŸ¥çœ‹å¯ç”¨æ¨¡æ¿åˆ—è¡¨
#### å‘½ä»¤ï¼štools -l
#### å‚æ•°åˆ—è¡¨
æ— 
##### ç¤ºä¾‹

```
doto
```
### å°†æ¨¡å—é›†æˆåˆ°NULS2.0è¿è¡Œç¯å¢ƒ
#### å‘½ä»¤:tools -p &lt;module folder>
#### å‚æ•°åˆ—è¡¨
| å‚æ•° | è¯´æ˜ |
| --- | --- |
| &lt;out folder> | æ¨¡å—çš„æ–‡ä»¶å¤¹å |
#### ç¤ºä¾‹
```
./tools -p demo
```
### <span id="registerTx">ä¸šåŠ¡æ¨¡å—ç›¸å…³æ¥å£åè®®</span>
ä¸šåŠ¡æ¨¡å—éœ€è¦ç»™äº¤æ˜“æ¨¡å—æä¾›3ä¸ªå›è°ƒå‡½æ•°ï¼Œäº¤æ˜“æ¨¡å—ä¼šé€šè¿‡websocketè°ƒç”¨è¿™3ä¸ªå‡½æ•°ï¼Œ3ä¸ªå‡½æ•°çš„å‚æ•°ç›¸åŒï¼Œå‘½åä¸åŒã€‚
#### éªŒè¯äº¤æ˜“
cmdåç§°ï¼štxValidator

ç”¨äºä¸šåŠ¡æ¨¡å—éªŒè¯txDataæ•°æ®æ˜¯å¦åˆæ³•ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥éªŒè¯coinDataç­‰æ•°æ®æ˜¯å¦ç¬¦åˆä¸šåŠ¡è¦æ±‚ã€‚å¦‚æœéªŒè¯ä¸é€šè¿‡ï¼Œäº¤æ˜“æ¨¡å—å°†ä¸¢å¼ƒæ­¤ç¬”äº¤æ˜“ã€‚
#### ä¿å­˜äº¤æ˜“ä¸šåŠ¡æ•°æ®
cmdåç§°ï¼štxCommit

ç”¨äºå°†äº¤æ˜“ä¸­çš„ä¸šåŠ¡æ•°æ®ä¿å­˜åˆ°èŠ‚ç‚¹æœ¬åœ°æ•°æ®åº“ï¼Œæˆ–åšç›¸åº”çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚åˆ°è¾¾æ­¤æ­¥çš„äº¤æ˜“éƒ½æ˜¯è¾¾æˆå…±è¯†çš„æ•°æ®ã€‚
#### å›æ»šäº¤æ˜“ä¸šåŠ¡æ•°æ®
cmdåç§°ï¼štxRollback

å½“åŒºå—å‘ç”Ÿå›æ»šæ—¶ï¼Œä¼šè§¦å‘å›è°ƒæ­¤å‡½æ•°ï¼Œä¸šåŠ¡æ¨¡å—åº”è¯¥åœ¨å‡½æ•°ä¸­æ¸…é™¤æ‰æ­¤ç¬”äº¤æ˜“ç›¸å…³çš„ä¸šåŠ¡æ•°æ®ï¼Œæˆ–åšç›¸åº”çš„é€†å‘å¤„ç†ã€‚
#### å›è°ƒå‡½æ•°å‚æ•°åˆ—è¡¨
| å‚æ•°åç§° | ç±»å‹ | å‚æ•°è¯´æ˜ |
| --- | --- | --- |
| chainId | int | é“¾idï¼ˆèŠ‚ç‚¹è¿è¡Œå¤šé“¾æ—¶åŒºåˆ†æ•°æ®æ¥æºï¼‰ |
| txList | list | äº¤æ˜“åˆ—è¡¨ |
| blockHeader | object | åŒºå—å¤´ |

####  ååºåˆ—åŒ–ï¼Œ[é€šç”¨åè®®](https://github.com/nuls-io/nuls-v2-docs/blob/master/design-zh-CHS/h.%E9%80%9A%E7%94%A8%E5%8D%8F%E8%AE%AE%E8%AE%BE%E8%AE%A1v1.3.md)
txListå’ŒblockHeaderä¸¤ä¸ªå‚æ•°çš„æ•°æ®æ˜¯é€šè¿‡16è¿›åˆ¶æ•°æ®çš„å½¢å¼ä¼ è¾“ï¼Œé¦–å…ˆéœ€è¦å°†16è¿›åˆ¶è½¬æ¢æˆbyteæ•°ç»„ï¼Œç„¶åå†æ ¹æ®ä¸åŒçš„è§„åˆ™ååºåˆ—åŒ–æˆç»“æ„åŒ–æ•°æ®ã€‚
##### [Transaction](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/data/Transaction.java)
txListå­˜å‚¨çš„æ˜¯ä¸€ä¸ªTransactionå¯¹è±¡çš„åˆ—è¡¨ï¼Œæ¯ä¸€ä¸ªitemé‡Œé¢æ˜¯Transactionå¯¹è±¡åºåˆ—åŒ–æˆ16è¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚ååºåˆ—åŒ–txListé¦–å…ˆä»[é€šç”¨åè®®](https://github.com/nuls-io/nuls-v2-docs/blob/master/design-zh-CHS/r.rpc-tool-websocket%E8%AE%BE%E8%AE%A1v1.3.md)ä¸­å–å‡ºtxListå‚æ•°çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªjsonçš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œç„¶åéå†æ•°ç»„å–å¾—å•ä¸ªTransactionå¯¹è±¡çš„åºåˆ—åŒ–å€¼ã€‚å°†åºåˆ—åŒ–å€¼è½¬æ¢æˆbyteæ•°ç»„ã€‚å†ä»byteæ•°ç»„ä¸­é€ä¸ªå–å‡ºå¯¹åº”çš„æ•°æ®å€¼ã€‚
byteæ•°ç»„ä¸­è¯»å–æ•°æ®çš„è§„åˆ™å¦‚ä¸‹ï¼š
1. 2ä¸ªbyteå­˜å‚¨æ— ç¬¦å·çš„16ä½intä¿å­˜äº¤æ˜“ç±»å‹ã€‚
2. 4ä¸ªbyteå­˜å‚¨æ— ç¬¦å·çš„32ä½intä¿å­˜äº¤æ˜“æ—¶é—´æˆ³ï¼ˆ1970å¹´1æœˆ1æ—¥åˆ°å½“å‰çš„ç§’æ•°ï¼‰
3. å˜é•¿ç±»å‹å­˜å‚¨remarkå­—ç¬¦ä¸²ï¼Œè§[å˜é•¿ç±»å‹è¯»å–æ–¹å¼](#å˜é•¿ç±»å‹å­˜å‚¨ç»“æ„)
4. å˜æˆç±»å‹å­˜å‚¨txDataå­—ç¬¦ä¸²ï¼Œä¸šåŠ¡è‡ªå®šä¹‰ï¼Œä½†ä»»ç„¶éœ€è¦å…ˆè½¬æ¢æˆbyteæ•°ç»„ã€‚
5. å˜é•¿ç±»å‹å­˜å‚¨coinDataå­—ç¬¦ä¸²ï¼Œä¸ºcoinDataå¯¹è±¡åºåˆ—åŒ–åçš„16è¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚è§[CoinDataååºåˆ—åŒ–æ–¹æ³•](#CoinData)
6. å˜é•¿ç±»å‹å­˜å‚¨äº¤æ˜“ç­¾åå­—ç¬¦ä¸²,ä¸ºTransactionSignatureå¯¹è±¡åºåˆ—åŒ–åçš„16è¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚

##### <span id="CoinData">[CoinData](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/data/CoinData.java)</span>
CoinDataå¯¹è±¡å­˜å‚¨äº†ä¸€ç¬”äº¤æ˜“ä¸­å‡ºå…¥é‡‘å…³ç³»ï¼Œä¸€ç¬”äº¤æ˜“å‡ºé‡‘è´¦æˆ·å’Œå…¥é‡‘è´¦æˆ·æ”¯æŒå¤šå¯¹å¤šçš„å…³ç³»ï¼Œåªè¦å‡ºé‡‘æ€»é¢å¤§äºç­‰äºå…¥é‡‘æ€»é¢åŠ æ‰‹ç»­è´¹äº¤æ˜“å°±å¯ä»¥æˆç«‹ã€‚
1. [varint](https://learnmeabitcoin.com/glossary/varint)ç±»å‹å­˜å‚¨å‡ºé‡‘è´¦æˆ·ä¿¡æ¯çš„åˆ—è¡¨ä¸ªæ•°ã€‚
2. æŒ‰é¡ºåºå­˜å‚¨å‡ºé‡‘è´¦æˆ·ä¿¡æ¯åˆ—è¡¨ï¼Œå‡ºé‡‘è´¦æˆ·ä¿¡æ¯ä¸ºCoinFromå¯¹è±¡ï¼Œæ³¨æ„æ­¤å¤„å¹¶æ²¡æœ‰å¯¹CoinFromå¯¹è±¡è¿›è¡Œ16è¿›åˆ¶å­—ç¬¦ä¸²å¤„ç†ã€‚
3. [varint](https://learnmeabitcoin.com/glossary/varint)ç±»å‹å­˜å‚¨å…¥é‡‘è´¦æˆ·ä¿¡æ¯çš„åˆ—è¡¨ä¸ªæ•°ã€‚
4. æŒ‰é¡ºåºå­˜å‚¨å…¥é‡‘è´¦æˆ·ä¿¡æ¯åˆ—è¡¨ï¼Œå…¥é‡‘è´¦æˆ·ä¿¡æ¯ä¸ºCoinToå¯¹è±¡ï¼Œæ³¨æ„æ­¤å¤„å¹¶æ²¡æœ‰å¯¹CoinToå¯¹è±¡è¿›è¡Œ16è¿›åˆ¶å­—ç¬¦ä¸²å¤„ç†ã€‚

##### <span id="CoinFrom">[CoinFrom](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/data/CoinFrom.java)</span>
1. å˜é•¿ç±»å‹å­˜å‚¨è´¦æˆ·åœ°å€ã€‚[Addressåºåˆ—åŒ–ä»£ç ](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/basic/AddressTool.java)
2. 2ä¸ªbyteå­˜å‚¨æ— ç¬¦å·16ä½intä¿å­˜èµ„äº§é“¾idã€‚
3. 2ä¸ªbyteå­˜å‚¨æ— ç¬¦å·16ä½intä¿å­˜èµ„äº§idã€‚
4. 32ä¸ªbyteå­˜å‚¨BigIntegerç±»å‹çš„æ•°å€¼æ•°æ®ä¿å­˜å‡ºé‡‘èµ„äº§æ•°é‡ã€‚
5. å˜é•¿ç±»å‹å­˜å‚¨è´¦æˆ·nonceå€¼ã€‚
6. 1ä¸ªbyteå­˜å‚¨é”å®šçŠ¶æ€ï¼ˆå…±è¯†ç”¨ï¼‰

##### <span id="CoinTo">[CoinTo](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/data/CoinTo.java)</span>
1. å˜é•¿ç±»å‹å­˜å‚¨è´¦æˆ·åœ°å€ã€‚[Addressåºåˆ—åŒ–ä»£ç ](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/basic/AddressTool.java)
2. 2ä¸ªbyteå­˜å‚¨æ— ç¬¦å·16ä½intä¿å­˜èµ„äº§é“¾idã€‚
3. 2ä¸ªbyteå­˜å‚¨æ— ç¬¦å·16ä½intä¿å­˜èµ„äº§idã€‚
4. 32ä¸ªbyteå­˜å‚¨BigIntegerç±»å‹çš„æ•°å€¼æ•°æ®ä¿å­˜å‡ºé‡‘èµ„äº§æ•°é‡ã€‚
5. 8ä¸ªbyteå­˜å‚¨å¸¦ç¬¦å·çš„64ä½longä¿å­˜é”å®šæ—¶é—´ï¼ˆé”å®šèµ„äº§çš„æ—¶é—´ï¼‰

##### <span id="TransactionSignature">[TransactionSignature](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/signture/TransactionSignature.java)</span>
äº¤æ˜“å‰é¢ä¼šå­˜åœ¨å¤šäººç­¾åçš„æƒ…å†µï¼Œæ‰€ä»¥TransactionSignatureé‡Œé¢å­˜å‚¨çš„å®é™…ä¸Šæ˜¯ç­¾åæ•°æ®åˆ—è¡¨ã€‚byteæ•°ç»„ä¸­æŒ‰é¡ºåºä¾æ¬¡å­˜å‚¨å¤šä¸ªç­¾åã€‚ååºåˆ—åŒ–æ—¶ä¾æ¬¡è½®è®­ã€‚
1. 1ä¸ªbyteå­˜å‚¨å…¬é’¥é•¿åº¦ã€‚
2. å…¬é’¥æ•°æ®ï¼ˆé•¿åº¦æ ¹æ®1ä¸­è·å–ï¼‰
3. å˜é•¿ç±»å‹å­˜å‚¨ç­¾åæ•°æ®ã€‚

##### <span id="BlockHeader">[BlockHeader](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/data/BlockHeader.java)</span>
BlockHeaderä¸ºåŒºå—å¤´å¯¹è±¡ï¼Œä¸»è¦å­˜å‚¨å‰ä¸€å—çš„hashå€¼ã€[merkle tree](https://en.wikipedia.org/wiki/Merkle_tree)çš„æ ¹hashå€¼ã€å‡ºå—æ—¶é—´æˆ³ã€åŒºå—é«˜åº¦ã€å—ä¸­çš„äº¤æ˜“æ€»æ•°ã€åŒºå—ç­¾åã€æ‰©å±•æ•°æ®ã€‚
åºåˆ—åŒ–è§„åˆ™ï¼š
1. 32ä¸ªbyteå­˜å‚¨å‰ä¸€ä¸ªå—çš„hashå€¼ã€‚
2. 32ä¸ªbyteå­˜å‚¨merkleæ ¹çš„hashå€¼ã€‚
3. 4ä¸ªbyteå­˜å‚¨æ— ç¬¦å·çš„32ä½intä¿å­˜å‡ºå—æ—¶é—´æˆ³ï¼ˆ1970å¹´1æœˆ1æ—¥åˆ°å½“å‰çš„ç§’æ•°ï¼‰ã€‚
4. 4ä¸ªbyteå­˜å‚¨æ— ç¬¦å·çš„32ä½intä¿å­˜åŒºå—é«˜åº¦ã€‚
5. 4ä¸ªbyteå­˜å‚¨æ— ç¬¦å·çš„32ä½intä¿å­˜å½“å‰å—ä¸­çš„äº¤æ˜“æ€»æ•°ã€‚
6. å˜é•¿ç±»å‹å­˜å‚¨æ‰©å±•æ•°æ®ã€‚
7. å˜é•¿ç±»å‹å­˜å‚¨äº¤æ˜“ç­¾åå­—ç¬¦ä¸²,ä¸ºBlockSignatureå¯¹è±¡åºåˆ—åŒ–åçš„16è¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚

##### <span id="BlockSignature">[BlockSignature](https://github.com/nuls-io/nuls-v2/blob/master/common/nuls-base/src/main/java/io/nuls/base/signture/BlockSignature.java)</span>
1. 1ä¸ªbyteå­˜å‚¨å…¬é’¥é•¿åº¦ã€‚
2. å…¬é’¥æ•°æ®ï¼ˆé•¿åº¦æ ¹æ®1ä¸­è·å–ï¼‰
3. å˜é•¿ç±»å‹å­˜å‚¨ç­¾åæ•°æ®ã€‚

##### <span id="å˜é•¿ç±»å‹å­˜å‚¨ç»“æ„">å˜é•¿ç±»å‹å­˜å‚¨ç»“æ„</span>
å˜é•¿ç±»å‹ç”±2éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†ä¸ºvarintç±»å‹å­˜å‚¨æ•°æ®æ‰€å byteä½çš„é•¿åº¦ï¼Œç¬¬äºŒéƒ¨åˆ†ä¸ºæ•°æ®éƒ¨åˆ†ã€‚è¯»å–å˜é•¿ç±»å‹ç»“æ„çš„æ–¹å¼æ˜¯å…ˆè¯»å–varintæ•°æ®ï¼Œå†‰è¯»å–å¯¹åº”é•¿åº¦çš„ä¸šåŠ¡æ•°æ®ã€‚
1. [varint](https://learnmeabitcoin.com/glossary/varint)ç±»å‹å­˜å‚¨æ•°æ®byteæ•°ç»„é•¿åº¦ã€‚
2. å°†ä¸šåŠ¡æ•°æ®è½¬æ¢æˆbyteæ•°ç»„å­˜å‚¨è¿›å»ã€‚




### æ¨¡å—æ¨¡æ¿åˆ—è¡¨
* [javaæ¨¡å—å¼€å‘æ¨¡æ¿](https://github.com/nuls-io/nuls-module-template-java)
* [åŒºå—é“¾æµè§ˆå™¨æ¨¡æ¿](https://github.com/nuls-io/nuls-module-explorer)

### <span id="doclist">æ–‡æ¡£åˆ—è¡¨</span>
* [Javaæ¨¡å—å¼€å‘æ¨¡æ¿ä½¿ç”¨æ–‡æ¡£](https://github.com/nuls-io/nuls-module-template-java)
* [åŠ å¯†é‚®ä»¶ç¤ºä¾‹æ¨¡å—è®¾è®¡æ–‡æ¡£](./example/æ¨¡å—è®¾è®¡æ–‡æ¡£.md)
* [è´¦æˆ·æ¨¡å—RPCæ¥å£æ–‡æ¡£](./document/account.md)
* [è´¦æœ¬æ¨¡å—RPCæ¥å£æ–‡æ¡£](./document/ledger.md)
* [äº¤æ˜“æ¨¡å—RPCæ¥å£æ–‡æ¡£](./document/transaction.md)
* [åŒºå—æ¨¡å—RPCæ¥å£æ–‡æ¡£](./document/block.md)
* [å…±è¯†æ¨¡å—RPCæ¥å£æ–‡æ¡£](./document/consensus.md)
* [ç½‘ç»œæ¨¡å—RPCæ¥å£æ–‡æ¡£](./document/netwrok.md)

## Contribution

Contributions to NULS are welcomed! We sincerely invite developers who experienced in blockchain field to join in NULS technology community. Details: s: https://nuls.communimunity/d/9-recruitment-of-community-developers To be a great community, Nuls needs to welcome developers from all walks of life, with different backgrounds, and with a wide range of experience.

## License

Nuls is released under the [MIT](http://opensource.org/licenses/MIT) license.
Modules added in the future may be release under different license, will specified in the module library path.

## Community

- [nuls.io](https://nuls.io/)
- [@twitter](https://twitter.com/nulsservice)
- [facebook](https://www.facebook.com/nulscommunity/)
- [YouTube channel](https://www.youtube.com/channel/UC8FkLeF4QW6Undm4B3InN1Q?view_as=subscriber)
- Telegram [NULS Community](https://t.me/Nulsio)
- Telegram [NULS ä¸­æ–‡ç¤¾åŒº](https://t.me/Nulscn)

####  
